CREATE VIEW [dbo].[vwDiabeticList]
AS
SELECT DISTINCT 
	PAT.KEY_PATIENT, 
	PAT.NAME, 
	PAT.SEX, 
	PAT.DOB, 
	PAT.SSN, 
	PAT.PHONE, 
	PAT.OFFICE_PHONE
FROM         dbo.PATIENT PAT 
	INNER JOIN dbo.PATIENT_APPOINTMENT 
	ON PAT.KEY_PATIENT = dbo.PATIENT_APPOINTMENT.NAME_IEN 
	INNER JOIN dbo.KG_ADC_DATA 
	ON dbo.PATIENT_APPOINTMENT.KEY_PATIENT_APPOINTMENT = dbo.KG_ADC_DATA.APPOINTMENT_IEN 
	INNER JOIN dbo.KG_ADC_DATA$ICD_DIAGNOSIS 
	ON dbo.KG_ADC_DATA.KEY_KG_ADC_DATA = dbo.KG_ADC_DATA$ICD_DIAGNOSIS.KEY_KG_ADC_DATA 
	INNER JOIN dbo.ICD_DIAGNOSIS 
	ON dbo.KG_ADC_DATA$ICD_DIAGNOSIS.ICD_DIAGNOSIS_IEN = dbo.ICD_DIAGNOSIS.KEY_ICD_DIAGNOSIS
WHERE     (dbo.ICD_DIAGNOSIS.CODE_NUMBER 
IN ('250.01', '250.03 ', '250.11', '250.13', '250.21', '250.23', '250.31', '250.33', '250.41', '250.43', '250.51', 
                      '250.53', '250.61', '250.63', '250.71', '250.73', '250.81', '250.83', '250.91', '250.93', '250.00', '250.02', '250.10', '250.12', '250.20', '250.22', '250.30', 
                      '250.32', '250.40', '250.42', '250.50', '250.52', '250.60', '250.62', '250.70', '250.72', '250.80', '250.82', '250.90', '250.92', '305.1'))
